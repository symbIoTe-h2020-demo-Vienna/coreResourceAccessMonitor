language: java

env:
  global:
    secure: "gz7dy+skKq90m1JDkcke2iwVxcWtM5PVEVHJoJ/FOXdunAjkEj2sWqX2IBxIJ9gTgZJHDIc1MAKDCoB7SALuEsbMetez8ceofSqO5dt3nudtKfQiPW8xV+otvx1R4Ok88l4wttPpRD51RHFRSKOALNhNKRUJGPVkwr7MuLCsVsgno4GC3YkyP7p/S4N44QwRWCQG5oo+aYulJJ7Fm8Hjav+H3+4JtenrhlCOTDr+eDQrU009TohoudLgaEzoWsLE9ubH5b2Mh2WlwzdluuaDa770YPIlfm7xXYsojlXs3c3T//yUN/5EBxBWnsgwg0DIjrOg8bN+63w+YHkxMET8XYlHDxQgDOP4nDcdDbjg3y6mwg03ihIeaAn0jeB3Vn39FVUq7LAwiOhDyLN38DPudyl9vAPgy290GODAxQ+tbPEcYs++qi4LH33CMLpK+hVd6zRaP6HjNwiJqjelnCPZnqviJGv3QPGR1HUz5OFscsN5otaAbIADaX3GeQS6PeX6+eCGH7igfRYv9QzspyFlFMAkh+McpUjW8gxPf1Ubp8hv9wOhjSTqIEF2qxxSezvuVzAKI8GyPQ18FaEX7fEHnCq3Ak3p2FERM3vHbpta6L9eDdV+Z8bh5JSk+5zQheBLaxIIhosUHXhWOeGebRM6v6MOSoRR5uohpgrxxQllusU="

jdk:
- oraclejdk8

branches:
  only:
  - staging

before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"

after_success:
- chmod a+x merge_script.sh
- BRANCHES_TO_MERGE_REGEX='staging' BRANCH_TO_MERGE_INTO=develop GITHUB_REPO=symbiote-h2020/coreResourceAccessMonitor
  ./merge_script.sh
- gradle test
- if [ -e ./gradlew ]; then ./gradlew jacocoTestReport;else gradle jacocoTestReport;fi
- bash <(curl -s https://codecov.io/bash)
