language: java

env:
  global:
    secure: "JM7Xq8mZIgGy5rBcPN7GHJBekrkK+DJCQ4Aq+krKBuxaF/XzQk263FfNOjuAbNEHS0DN7bRuXB1pRTqBf/Ob7QCZTU7qBdQAQPXHXZBqJcUSQlthrJP5a39BnHcOKDRjFlBlG85uC06GXMRV8NkLv+q/8P78uDPZ3VwWj7H7IyWeXOHRwsggtcVMHpvvSgRc78JwWPkudiAfqJIKuEPpZGYhCAhbiiKqPI9QWo+Y5c0hqa4cHGxdeS/vnbqQBYCY+WMgqe2UEtEoYdTi19bHlMRO8iJJL718tmN5NGM01jQ/OQqROP+251L1EStDTTnhbubjiOhk0DXH78K3OiyeinNHFErmvKDIf9nanVuK5Y0TaGNPjMzNLIc3H7b7xp64pKF3AFbBNgPiCJ1wrsXUmw78IW9MfRPZo4vWJQtU5wna5lNB1FbSsTLaXbrnz6xBG9Ezynf0GTxkMxDMkvpjONEW1ydM0vv1goPkA9z1fdju+6vsZF9uo4/7MAowApn3szweSYfX/Cnc/2jMdWVWYW16ddy9XaZqhSkikwTDhIoW0uMDRYKOyvDculzH8/Zn9/tN5xbb1HG+OBdqsXhAg37JxMa/OzuBjklcGIzHkPF9sEYmj+v/WCpFxE/h23nCwrp0JNlwW4nF3y6dbncdm/W+0X3XP4Myjxw46TUSP6k="

jdk:
- oraclejdk8

services:
  - mongodb
  - rabbitmq

sudo: required

branches:
  only:
  - staging

before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"

after_success:
- chmod a+x merge_script.sh
- BRANCHES_TO_MERGE_REGEX='staging' BRANCH_TO_MERGE_INTO=develop GITHUB_REPO=symbiote-h2020/coreResourceAccessMonitor
  ./merge_script.sh
- bash <(curl -s https://codecov.io/bash)
